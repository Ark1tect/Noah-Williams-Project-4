<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Project 4</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: relative;
            top: 0;
            bottom: 0;
            width: 50%;
        }
    </style>
</head>

<body>
    <style>
        #map {
            position: fixed;
            width: 75%;
            height: auto;
        }

        #features {
            width: 25%;
            margin-left: 75%;
            font-family: sans-serif;
            text-align: justify;
            overflow-y: scroll;
            background-color: whitesmoke;
        }

        section {
            padding: 100px 30px 100px 30px;
            line-height: 40px;
            border-bottom: 1px solid #ddd;
            background-color: whitesmoke;
            color:s grey;
            font-size: 20px;
        }

        section.active {
            opacity: 1;
        }

        section:last-child {
            border-bottom: none;
            margin-bottom: 200px;
        }

        #title-bar {
            float: above;
            position: relative;
        }

        #header {
            padding: 20px 20px 20px 20px;
            text-align: center;
            font-size: 16px;
            color: steelblue;
        }

        #marker {
            background-image: url('https://docs.mapbox.com/mapbox-gl-js/assets/washington-monument.jpg');
            background-size: cover;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
        }
        h3{
            color:steelblue;
            text-align: center;
            border-color: slategrey;
        }
    </style>


    <div id="map"></div>
    <div id="features">
        <div id="header">
            <h1>The Hudson River: Hydropower Highway</h1>
        </div>
        <section id="overview" class="active">
            <h3>Champlain Hudson <br>Power Express</h3>
            <p>
                The Champlain Hudson Power Express (CHPE) is an ambitious clean energy project that will bring hydropower
                generated in Quebec down through Lake Champlain and the Hudson River valley to New York City. The total route will strech over 339 miles. The project has recieved permits from New York State Public Service Commission, the United States Department of Energy and the U.S. Army Corps of Engineers, and construction is now underway.
                The line of travel shown on this map is an approximation based on docuemnts published by CHPE.
            </p>
        </section>
        <section id="canada-border" class="active">
            <h3>Canadian Border</h3>
            <p>
                The power lines enter the US under the Hudson River
            </p>
        </section>
        <section id="mill-bay">
            <h3>Putnam New York</h3>
            <p>
                In Putnam, the transmission lines move from submarine to terrestrial

            </p>
        </section>
        <section id="astoria-converter">
            <h3>Astoria Converter Station</h3>
            <p>
                The transmission lines will connect to a new power station in the Ditmars neighborhood of Astoria.
                <br>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
                ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
                fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia
                deserunt mollit anim id est laborum.

            </p>
        </section>
        <section id="rainey-substation">
            <h3>Rainey Substation</h3>
            <p>
                The final terminus of the project will be along the East River at the exisiting Rainey substation

                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
                ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
                fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia
                deserunt mollit anim id est laborum.

            </p>
        </section>


        <small id="citation">
            Adapted from
            <a href="https://docs.mapbox.com/mapbox-gl-js/example/scroll-fly-to/">Mapbox GL JS. </a>
            Information sourced from
            <a href="https://chpexpress.com/construction-progress/#InteractiveProjectMap">CHPE Project Map</a>
        </small>
        </section>
    </div>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoibncyMjU3IiwiYSI6ImNsdXU4emozMzA3ZHoyam11Zmx6NWxqajcifQ._r9IkgwnilyVDH2Mh6MEzg';
        const map = new mapboxgl.Map({
            container: 'map',
            // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
            style: 'mapbox://styles/nw2257/clvojdept04la01pe9y0sciq7',
            center: [-73.81555790391995, 42.74982891965341],
            zoom: 6.5,
            pitch: 45
        });
   map.on('load', () => {
        map.addSource('route', {
            'type': 'geojson',
            'data': {
                'type': 'Feature',
                'properties': {},
                'geometry': {
                    'type': 'LineString',
                    'coordinates': [
                        [-73.338663, 45.000253],
                        [-73.308185, 44.249749],
                        [-73.429555, 44.026890],
                        [-73.371796, 43.740724],
                        [-73.398232, 43.734701],
                        [-74.035911, 42.820588],
                        [-73.849511, 42.434100],
                        [-73.980632, 41.183822],
                        [-73.886337, 41.100181],
                        [-73.933049, 40.877310],
                        [-73.908314, 40.865887],
                        [-73.932362, 40.832645],
                        [-73.927651, 40.801043],
                        [-73.905612, 40.793425],
                        [-73.899256, 40.784002],
                        [-73.907940, 40.780810],
                        [-73.915627, 40.786009],
                        [-73.924724, 40.778632],
                        [-73.933399, 40.766250],
                        [-73.936276, 40.767582],
                        [-73.939655, 40.766412],
                        [-73.941759,40.763357],
                        [-73.9430711, 40.763141],
                    ]
                }
            }
        });
        map.addLayer({
            'id': 'route',
            'type': 'line',
            'source': 'route',
            'layout': {
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': 'steelblue',
                'line-opacity':0.8,
                'line-width': 8.5
            }
        });
    });
        const chapters = {
            'overview': {
                bearing: 0,
                center: [-73.81555790391995, 42.74982891965341],
                zoom: 6.5,
                pitch: 20
            },
            'canada-border': {
                duration: 3000,
                bearing: 0,
                center: [-73.34026313015306, 45.01734476478177],
                zoom: 10,
                pitch: 20
            },
            'mill-bay': {
                duration: 6000,
                center: [-73.37417303691613, 43.740171598917975],
                bearing: -25,
                zoom: 15,
                pitch: 0
            },
            'astoria-converter': {
                bearing: 0,
                center: [-73.90039723787821, 40.78463367212406],
                zoom: 15,
                speed: 0.7,
                pitch: 40
            },
            'rainey-substation': {
                duration: 5000,
                bearing: -15,
                center: [-73.94299233751983, 40.76330816273322],
                zoom: 15
            },

        };
        const astoriaplant = new mapboxgl.Marker()
            .setLngLat([-73.89980360665398, 40.78419995146565])
            .addTo(map);

        let activeChapterName = 'canada-border';
        function setActiveChapter(chapterName) {
            if (chapterName === activeChapterName) return;

            map.flyTo(chapters[chapterName]);

            document.getElementById(chapterName).classList.add('active');
            document.getElementById(activeChapterName).classList.remove('active');

            activeChapterName = chapterName;
        }

        function isElementOnScreen(id) {
            const element = document.getElementById(id);
            const bounds = element.getBoundingClientRect();
            return bounds.top < window.innerHeight && bounds.bottom > 0;
        }

        // On every scroll event, check which element is on screen
        window.onscroll = () => {
            for (const chapterName in chapters) {
                if (isElementOnScreen(chapterName)) {
                    setActiveChapter(chapterName);
                    break;
                }
            }
        };
    </script>

</body>

</html>